<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="React Native IAP Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="React Native IAP Blog Atom Feed"><title data-react-helmet="true">Lifecycle | React Native IAP</title><meta data-react-helmet="true" property="og:url" content="https://react-native-iap.dooboolab.com/docs/usage_instructions/connection_lifecycle"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Lifecycle | React Native IAP"><meta data-react-helmet="true" name="description" content="Initializing"><meta data-react-helmet="true" property="og:description" content="Initializing"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://react-native-iap.dooboolab.com/docs/usage_instructions/connection_lifecycle"><link data-react-helmet="true" rel="alternate" href="https://react-native-iap.dooboolab.com/docs/usage_instructions/connection_lifecycle" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://react-native-iap.dooboolab.com/docs/usage_instructions/connection_lifecycle" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.36aa7f87.css">
<link rel="preload" href="/assets/js/runtime~main.85aab6c1.js" as="script">
<link rel="preload" href="/assets/js/main.a5ca3dc9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="react ntaive iap" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="react ntaive iap" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">React Native IAP</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/dooboolab/react-native-iap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="react ntaive iap" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="react ntaive iap" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">React Native IAP</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/dooboolab/react-native-iap" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">React Native IAP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installing">Installing</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Usage instructions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/usage_instructions/connection_lifecycle">Lifecycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage_instructions/retrieve_available">Retrieving available items</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage_instructions/purchase">Making a purchase</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage_instructions/restoring_purchases">Restoring purchases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage_instructions/receipt_validation">Validating receipts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage_instructions/using_hooks">Using hooks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_reference/available_purchase">AvailablePurchase</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_reference/methods">Available Methods</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_reference/product">Product</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/manual_install">Manual installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/amazon">Amazon IAP Support</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/support_us">Supporting react-native-iap</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Lifecycle</h1></header><div class="markdown"><h2 id="initializing">Initializing</h2><p>In order to initialize the native modules, call <code>initConnection()</code> early in the lifecycle of your application. This should be done at a top-level component as the library caches the native connection. Initializing just before you needed is discouraged as it incurrs on a performance hit. Calling this method multiple times without ending the previous connection will result in an error. Not calling this method will cause other method calls to be rejected as connection needs to be established ahead of time. </p><pre><code class="language-javascript">import * as RNIap from &#x27;react-native-iap&#x27;;

componentDidMount() {
    RNIap.initConnection();
    ...
</code></pre><h2 id="ending-connection">Ending Connection</h2><p>In order to release the resources, call <code>endConnection()</code> when you no longer need any interaction with the library.</p><pre><code class="language-javascript">componentWillUnmount() {
  ...
  RNIap.endConnection();
}
</code></pre><h2 id="dos-and-donts">Dos and Don&#x27;ts</h2><p>You shoud not call <code>initConnection</code> and <code>endConnection</code> every time you need to interact with the library. This is considered an anti-pattern as it consumes more time, resources and could lead to undesired side effects such as many callbacks.</p><h3 id="-do">‚úÖ DO:</h3><pre><code class="language-javascript">import * as RNIap from &#x27;react-native-iap&#x27;;

componentDidMount() {
  await RNIap.initConnection();

  await RNIap.getProducts(productIds)
  ...
}

buyProductButtonClick() {
  //startPurchaseCode
}

bubscribeButtonClick() {
  //startPurchaseCode
}


componentWillUnmount() {
  ...
  RNIap.endConnection();
}
</code></pre><h3 id="-dont-">‚ùå DON&#x27;T :</h3><pre><code class="language-javascript">import * as RNIap from &#x27;react-native-iap&#x27;;

componentDidMount() {
  ...
}

const buyProductButtonClick = async() =&gt; {
  await RNIap.initConnection();

  await RNIap.getProducts(productIds)
  // Purchase IAP Code
  ...
    await RNIap.endConnection();
}

const subscribeButtonClick = async() =&gt; {
  await RNIap.initConnection();

    await RNIap.getProducts(productIds)
    //Purchase Subscription Code
    ...
    await RNIap.endConnection();
}

componentWillUnmount() {
  ...
}
</code></pre></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/dooboolab/react-native-iap/edit/master/docs/docs/usage_instructions/connection_lifecycle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/installing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Installing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/usage_instructions/retrieve_available"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Retrieving available items ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#initializing" class="table-of-contents__link">Initializing</a></li><li><a href="#ending-connection" class="table-of-contents__link">Ending Connection</a></li><li><a href="#dos-and-donts" class="table-of-contents__link">Dos and Don&#39;ts</a><ul><li><a href="#-do" class="table-of-contents__link">‚úÖ DO:</a></li><li><a href="#-dont-" class="table-of-contents__link">‚ùå DON&#39;T :</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">GitHub</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/dooboolab/react-native-iap/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues</a></li><li class="footer__item"><a href="https://github.com/dooboolab/react-native-iap/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions</a></li><li class="footer__item"><a href="https://github.com/dooboolab/react-native-iap/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pull requests</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">This is an Open Source project using the MIT license built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.85aab6c1.js"></script>
<script src="/assets/js/main.a5ca3dc9.js"></script>
</body>
</html>